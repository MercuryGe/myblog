<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>我的文章修改页面</title>
    <script src="jquery-1.9.1.min.js"></script>

    <script>
        // 首先要交互数据集，显示文章详情
        jQuery(function () { // 页面加载完成后，执行当前jQuery
            var params = location.search; // ?id=xxx;
            id = params.substring(1).split("=")[1]; //理论上应该是单个整数了
            alert(id);
            jQuery.getJSON("init",{"id":id},function (data) {
                if(data != null && data.succ == 1){
                    alert("文章内容查询成功");
                    jQuery("#title").val(data.art.title);
                    jQuery("#content").val(data.art.content);
                }else{
                    alert("查询失败，" + data.msg);
                }
            })
        })

        // 修改文章内容
        function mysub(type) {
            var title = jQuery("#title");
            var content = jQuery("#content");
            if(type == 2){
                //todo:清空操作
                return false;
            }
            // todo:提交前进行非空校验
            jQuery.getJSON("upart", {
                "id":id,
                "title":title.val(),
                "content":content.val()
            },function (data) {
                if(data != null && data.succ == 1){
                    alert("修改成功");
                    location.href = "myartlist.html";
                }else{
                    alert("修改失败，" + data.msg);
                }
            })
        }
    </script>
</head>
<body>
<div style="margin-top: 30px; margin-left: 50px">
    <h1>文章修改功能</h1>
    标题：<input type="text" id="title" ><p></p>
    正文：<textarea id="content" style="width: 80%; height: 300px;"></textarea><p></p>
    <input value=" 提 交 " type="button" onclick="mysub(1)">
    <input value=" 清 空 " type="button" onclick="mysub(2)">
</div>
</body>
</html>